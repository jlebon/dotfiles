#!/bin/bash
set -euo pipefail

# Paste the contents of the clipboard (or tmux buffer), but slowly. This is
# useful for pasting into the GRUB menu on the QEMU serial console.

if [ -n "${TMUX_BUFFER:-}" ]; then
  buffer=$(tmux show-buffer)
else
  buffer=$(wl-paste)
fi

for (( i=0; i<${#buffer}; i++ )); do
  tmux send-keys "${buffer:$i:1}"
  sleep 0.05
done
